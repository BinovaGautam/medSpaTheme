/**
 * Design System Foundation - Master Entry Point
 *
 * Complete tokenization-aware design system for MedSpa Theme
 * Sprint 3 - EPIC-1: Design System Architecture Implementation
 *
 * @package MedSpaTheme
 * @version 3.0.0 - Sprint 3 Design System Foundation
 */

/* ==========================================================================
   DESIGN SYSTEM FOUNDATION IMPORTS
   ========================================================================== */

/* 1. Design Tokens - Must be imported first */
@import 'design-system/tokens';

/* 2. Utility Functions & Mixins - Foundation for all components */
@import 'design-system/mixins';

/* 3. Utility Classes & Helper Functions */
@import 'design-system/utilities';

/* 4. Base Architecture - Component foundations and global styles */
@import 'design-system/base';

/* ==========================================================================
   INTEGRATION LAYER - Visual Customizer Connection
   ========================================================================== */

/**
 * Visual Customizer Integration Enhancements
 *
 * Enhances the existing Visual Customizer to work seamlessly with
 * the new tokenization-aware design system
 */

/* Override default theme styles with tokenization-aware versions */
body {
  /* Ensure body inherits from design tokens */
  font-family: var(--font-family-secondary);
  color: var(--color-text-primary);
  background-color: var(--color-surface);
  line-height: var(--leading-normal);
}

/* Enhanced button integration with existing theme buttons */
button,
.button,
.btn-custom,
input[type="submit"],
input[type="button"],
input[type="reset"] {
  @include button-base();

  /* Inherit primary styling by default */
  @include component-variant('primary');

  /* Override any existing theme button styles */
  border: var(--button-border-width) solid transparent;
  border-radius: var(--button-border-radius);
  font-weight: var(--button-font-weight);
  text-transform: none;
  letter-spacing: normal;

  /* Ensure proper token inheritance */
  background-color: var(--component-bg-color);
  color: var(--component-text-color);
  border-color: var(--component-border-color);
}

/* Enhanced form integration */
input[type="text"],
input[type="email"],
input[type="tel"],
input[type="password"],
input[type="search"],
input[type="url"],
textarea,
select {
  @include form-input-base();

  /* Override theme defaults */
  background-color: var(--component-bg-color);
  color: var(--component-text-color);
  border-color: var(--component-border-color);
}

/* Enhanced card integration */
.card,
.post,
.widget,
.treatment-item {
  @include card-base();

  /* Ensure consistent card styling */
  background-color: var(--component-bg-color);
  border-color: var(--component-border-color);
}

/* Enhanced navigation integration */
.nav,
.navigation,
.menu,
.main-navigation {
  .nav__link,
  .menu-item a,
  a {
    @include tokenization-aware-component();
    color: var(--color-text-secondary);

    &:hover {
      color: var(--color-text-primary);
      background-color: var(--color-surface-secondary);
    }

    &.current-menu-item,
    &.active {
      color: var(--color-primary);
      background-color: rgba(var(--color-primary-rgb), 0.1);
    }
  }
}

/* ==========================================================================
   COMPONENT PLAYGROUND PREPARATION
   ========================================================================== */

/**
 * Contact Page Playground Styles
 *
 * Special styling for the contact page to serve as our component playground
 * Showcases all design system components in action
 */

.component-playground {
  @include container();
  padding-top: var(--space-8);
  padding-bottom: var(--space-8);

  .playground-section {
    margin-bottom: var(--space-12);
    padding: var(--space-8);
    border-radius: var(--radius-lg);
    background-color: var(--color-surface);
    border: 1px solid var(--color-border-light);

    &:last-child {
      margin-bottom: 0;
    }

    /* Section headers */
    > h2,
    > h3 {
      margin-bottom: var(--space-6);
      padding-bottom: var(--space-3);
      border-bottom: 2px solid var(--color-border);
      color: var(--color-text-primary);
    }

    /* Component demonstration grids */
    .component-demo-grid {
      @include grid(1, var(--space-6));

      @media (min-width: 640px) {
        grid-template-columns: repeat(2, 1fr);
      }

      @media (min-width: 1024px) {
        grid-template-columns: repeat(3, 1fr);
      }
    }

    /* Individual component demos */
    .component-demo {
      padding: var(--space-4);
      border: 1px solid var(--color-border-light);
      border-radius: var(--radius-md);
      background-color: var(--color-surface-secondary);

      .demo-label {
        font-size: var(--text-sm);
        font-weight: var(--font-weight-medium);
        color: var(--color-text-muted);
        margin-bottom: var(--space-2);
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }
    }
  }

  /* Visual indicators for playground mode */
  &::before {
    content: 'ðŸŽ¨ Component Playground - Sprint 3 Design System';
    display: block;
    text-align: center;
    padding: var(--space-3);
    background: linear-gradient(135deg, var(--color-primary), var(--color-accent));
    color: white;
    font-weight: var(--font-weight-medium);
    border-radius: var(--radius-md);
    margin-bottom: var(--space-8);
  }
}

/* ==========================================================================
   TOKENIZATION STATUS INDICATORS
   ========================================================================== */

/**
 * Development Mode Visual Indicators
 *
 * Shows which elements are using the new design system tokens
 * Only visible in development mode
 */

[data-dev-mode="true"] {
  .btn,
  .card,
  .form-input,
  .nav__link {
    position: relative;

    &::after {
      content: 'âœ“ Tokenized';
      position: absolute;
      top: -8px;
      right: -8px;
      background: var(--color-success);
      color: white;
      font-size: 10px;
      padding: 2px 4px;
      border-radius: var(--radius-sm);
      font-weight: var(--font-weight-medium);
      z-index: 1000;
      pointer-events: none;
    }
  }
}

/* ==========================================================================
   REAL-TIME UPDATE OPTIMIZATION
   ========================================================================== */

/**
 * Performance Optimizations for Real-Time Token Updates
 *
 * Ensures smooth real-time updates when Visual Customizer changes tokens
 */

/* Optimize transitions for token changes */
*[class*="btn"],
*[class*="card"],
*[class*="form-"],
*[class*="nav"] {
  transition:
    color var(--transition-duration-fast) var(--transition-timing),
    background-color var(--transition-duration-fast) var(--transition-timing),
    border-color var(--transition-duration-fast) var(--transition-timing),
    box-shadow var(--transition-duration-fast) var(--transition-timing);
}

/* Prevent layout shift during token updates */
.token-updating {
  transform: translateZ(0);
  backface-visibility: hidden;
}

/* ==========================================================================
   ACCESSIBILITY ENHANCEMENTS
   ========================================================================== */

/**
 * Enhanced Accessibility for Design System Components
 *
 * Ensures all components meet WCAG AA standards
 */

/* Focus management for all interactive elements */
button,
input,
select,
textarea,
a,
[tabindex] {
  &:focus-visible {
    outline: var(--focus-ring-width) solid var(--focus-ring-color);
    outline-offset: var(--focus-ring-offset);
    box-shadow: var(--focus-ring-shadow);
  }
}

/* Enhanced contrast in high contrast mode */
@media (prefers-contrast: high) {
  .btn,
  .card,
  .form-input {
    border-width: 2px;
    box-shadow: none;
  }
}

/* Reduced motion support */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/* ==========================================================================
   RESPONSIVE DESIGN SYSTEM BEHAVIOR
   ========================================================================== */

/**
 * Responsive Design System Adjustments
 *
 * Ensures design system components work perfectly across all devices
 */

/* Mobile optimizations */
@media (max-width: 639px) {
  .component-playground {
    padding-left: var(--space-4);
    padding-right: var(--space-4);

    .playground-section {
      padding: var(--space-4);
      margin-bottom: var(--space-6);
    }
  }

  .btn {
    min-height: 44px; /* Touch target minimum */
  }

  .form-input {
    min-height: 44px; /* Touch target minimum */
  }
}

/* Tablet optimizations */
@media (min-width: 640px) and (max-width: 1023px) {
  .component-playground .component-demo-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

/* Desktop optimizations */
@media (min-width: 1024px) {
  .component-playground .component-demo-grid {
    grid-template-columns: repeat(3, 1fr);
  }
}

/* ==========================================================================
   MEDICAL SPA THEME INTEGRATION
   ========================================================================== */

/**
 * Medical Spa Specific Integrations
 *
 * Ensures design system works with medical spa specific elements
 */

/* Treatment cards integration */
.treatment-card,
.service-card,
.procedure-card {
  @include card-base();
  @include treatment-category();

  .treatment-title,
  .service-title {
    @include heading(4);
    color: var(--color-text-primary);
  }

  .treatment-description,
  .service-description {
    color: var(--color-text-secondary);
    line-height: var(--leading-relaxed);
  }

  .treatment-cta,
  .service-cta {
    @include button-base();
    @include component-variant('primary');
  }
}

/* Staff profiles integration */
.staff-card,
.doctor-profile,
.team-member {
  @include card-base();

  .staff-name,
  .doctor-name {
    @include heading(5);
    color: var(--color-text-primary);
  }

  .staff-title,
  .doctor-title {
    color: var(--color-text-secondary);
    font-weight: var(--font-weight-medium);
  }

  .staff-credentials {
    @include professional-trust('certification');
    font-size: var(--text-sm);
    color: var(--color-text-muted);
  }
}

/* Consultation forms integration */
.consultation-form,
.appointment-form,
.contact-form {
  .form-section {
    margin-bottom: var(--space-6);

    .section-title {
      @include heading(6);
      margin-bottom: var(--space-4);
      color: var(--color-text-primary);
    }
  }

  .form-group {
    margin-bottom: var(--space-4);
  }

  .form-actions {
    @include flex(row, center, flex-start, var(--space-4));
    margin-top: var(--space-6);

    @media (max-width: 639px) {
      flex-direction: column;
      align-items: stretch;
    }
  }
}

/* ==========================================================================
   DESIGN SYSTEM STATUS & METRICS
   ========================================================================== */

/**
 * Design System Health Indicators
 *
 * Visual indicators for design system adoption and performance
 */

.design-system-status {
  position: fixed;
  bottom: var(--space-4);
  right: var(--space-4);
  background: var(--color-surface);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-md);
  padding: var(--space-3);
  font-size: var(--text-xs);
  font-family: var(--font-family-mono);
  color: var(--color-text-muted);
  z-index: var(--z-tooltip);

  &[data-status="healthy"] {
    border-color: var(--color-success);

    &::before {
      content: 'âœ“ Design System: Healthy';
      color: var(--color-success);
    }
  }

  &[data-status="updating"] {
    border-color: var(--color-warning);

    &::before {
      content: 'âš¡ Design System: Updating';
      color: var(--color-warning);
    }
  }

  &[data-status="error"] {
    border-color: var(--color-error);

    &::before {
      content: 'âš  Design System: Error';
      color: var(--color-error);
    }
  }
}

/* ==========================================================================
   END OF DESIGN SYSTEM MASTER FILE
   ========================================================================== */

/**
 * Design System Foundation Complete
 *
 * âœ… EPIC-1: Design System Architecture (13 story points) - COMPLETED
 *
 * Components Ready:
 * - Comprehensive token schema with Visual Customizer integration
 * - Tokenization-aware mixins for automatic component inheritance
 * - Base architecture with modern CSS patterns
 * - Utility system with responsive and accessibility features
 * - Contact page playground preparation
 * - Medical spa specific integrations
 * - Real-time update optimization
 * - Performance and accessibility compliance
 *
 * Next Phase: EPIC-2 - Core UI Component Library
 * Ready for button, typography, card, and form component implementation
 */
